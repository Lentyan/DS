# DS
В данном репозитории располагается ML-часть сервиса для прогнозирования спроса на товары 

**Требования к ML сервису**

Штука, которая делает прогноз. Вариант реализации:

Инференс должен выполняться лишь один раз в день.
- Запущенный сервис ходит в БД через API gateway
- получает список товаров, для которых надо выполнить запрос
- по очереди запрашивает информацию для каждого товара, делает инференс, отправляет результат в БД


**Краткое описание:**

Необходимо создать алгоритм прогноза спроса на 14 дней для товаров собственного 
производства. Гранулярность ТК-SKU-День. 

**Задача:**

Разработать интерпретируемую, описывающую правильные
зависимости (повышение цены вызывает логичное падение спроса), модель прогноза спроса.

Дальше необходимо сделать подневной прогноз спроса на тестовом периоде для каждого товара
и магазина, и команда Ленты оценит его качество в сравнении с свершившимся фактом. 
Метрикой качества будет выступать WAPE, посчитанный на уровне товар, магазин, день. Если 
есть пропущенные значения и по каким-то товарам не предоставлен прогноз, прогноз считается
равным нулю.


**Цель:**
Построить модель прогноза спроса, которая позволит минимизировать количество списаний и не допустить "пустых полок".

**Описание решения:**

Даный проект был успешно завершен. Мы ознакомились с диапазонами значений каждого столбца в наших данных и убедились 
в отсутствии пропусков и дубликатов. Мы также подробно изучили выбросы, которые оказались праздничными продажами, 
и решили сохранить их.

Затем мы удалили строки с отрицательными продажами и строки, в которых количество продаж равно нулю, но сумма продаж не равна нулю. 
С августа по декабрь мы заметили слегка убывающий тренд, а с середины марта – возрастающий тренд.

Для оценки сезонности мы хотели бы просмотреть несколько лет данных, но у нас был только один год. 
В этих данных не было видно сезонности по временам года, но на обоих графиках были четко видны пики, связанные с праздниками.

Признаки категории товара были иерархическими, поэтому мы ожидали, что они будут сильно коррелировать между собой. 
Для обучения модели мы выбрали только один признак самого низкого уровня – pr_subcat_id.

Признаки магазина также сильно коррелировали между собой, так что мы исключили код подразделения st_division_code и 
выбрали более детализированный признак города st_city_id. Между признаками была обнаружена высокая корреляция, 
поэтому мы провели нормализацию признаков перед обучением модели.

На основе анализа данных мы обнаружили, что чем ниже цена товара, тем больше его продано, что вполне логично. 
Промо-акции составляют почти половину всех продаж, что необходимо учесть при разработке модели.

Мы добавили в модель такие переменные, как день недели, среднее значение и лаги, а также использовали сглаживание скользящим средним. 
Затем мы отсортировали датасет по дате и выделили последние 28 дней, разделив их на две части: 14 дней для валидации и 14 дней для тестирования.

Использовали модель CatBoostRegressor и получили метрику wape_test, равную 0,27397037287087167. 
Это означает, что модель хорошо работает и может быть использована для прогнозирования продаж.

